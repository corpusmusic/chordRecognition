function data = getData( filename, songList )
% filename is the path of all_chords.csv
% songList is a vector with the song indices to extract information from
% data outputs the song index, start time, end time and chord ID.

M = importdata(filename);
nSamples = 0;
for i = 2: 255214 %length(M)
    temp = strsplit(M{i},',');
    if ~isempty(find(songList == str2num(temp{1}))) 
        nSamples = nSamples + 1;
        songListData(nSamples,:) = [temp(1) temp(2) temp(8) temp(11)];
    end
end 

% Now clean the data

cSamples = 0;
for i = 1: nSamples
    if strcmp(songListData(i,3),'NA') == 0
            if strcmp(songListData(i,4),'maj') == 1 || strcmp(songListData(i,4),'min') == 1 
                if songListData(i,1) == songListData(i+1,1) %% if next sample corresponds to the same song
                    cSamples = cSamples + 1;
                    switch songListData(i,4)
                        case 'maj'
                            cleaned_data(cSamples,:) = [str2num(songListData(i,1)) str2num(songListData(i,2)) str2num(songListData(i+1,2)) str2num(songListData(i,3))];
                        case 'min'
                            cleaned_data(cSamples,:) = [str2num(songListData(i,1)) str2num(songListData(i,2)) str2num(songListData(i+1,2)) str2num(songListData(i,3))+1];
                    end
                end
            end
    end
        end
end

end
